<div class="dashboard-container" [ngClass]="{'dark-mode': isDarkMode}">
  <!-- Sidebar -->
  <aside class="sidebar" [class.open]="sidebarOpen">
    <div class="sidebar-header">
      <h2 class="sidebar-logo">MOScholar</h2>
      <button class="close-sidebar" (click)="toggleSidebar()" *ngIf="sidebarOpen" aria-label="Close sidebar">‚úï</button>
    </div>
    <nav class="sidebar-nav">
      <ul>
        <li><button class="sidebar-btn" (click)="coursePage()" aria-label="View enrolled courses">My Courses</button></li>
        <li><button class="sidebar-btn" (click)="logout()" aria-label="Log out">Logout</button></li>
      </ul>
    </nav>
  </aside>
  <!-- Topbar -->
  <header class="topbar" style="background-color: rgb(13,17,23);">
    <div class="topbar-left">
      <button class="menu-toggle" (click)="toggleSidebar()" aria-label="Toggle sidebar">‚ò∞</button>
      <h1 class="topbar-logo">MOScholar</h1>
    </div>
    <div class="topbar-right ">
      <span class="cart container" style="font-weight: bolder;">Add to Cart</span>
      <button class="theme-toggle" (click)="toggleTheme()" [attr.aria-label]="isDarkMode ? 'Switch to light mode' : 'Switch to dark mode'">
        {{ isDarkMode ? '‚òÄÔ∏è' : 'üåô' }}
      </button>
    </div>
  </header>
  <!-- Main Content -->
  <main class="main-content">
    <section class="stats">
      <div class="search-container">
        <input type="text" [(ngModel)]="searchQuery" (input)="searchCourses()" placeholder="Search courses..." aria-label="Search courses by title or description" class="search-input">
      </div>
      <span class="user-greeting">Welcome, {{ role }} {{ Lastname }}</span>
      <div class="stat">Total Courses: {{ allCourses.length }}</div>
      <div class="filter-container">
        <button class="filter-btn" (click)="toggleFilter()" aria-label="Toggle filter options">Filter By</button>
        <div id="filterOptions" class="filter-options bg-dark" [class.show]="showFilter">
          <button [class.active]="activeFilter === 'latest'" (click)="sortCourses('latest')" aria-label="Sort by latest">Latest</button>
          <button [class.active]="activeFilter === 'old'" (click)="sortCourses('old')" aria-label="Sort by oldest">Oldest</button>
          <button [class.active]="activeFilter === 'popular'" (click)="sortCourses('popular')" aria-label="Sort by popularity">Popular</button>
          <button [class.active]="activeFilter === 'price-low'" (click)="sortCourses('price-low')" aria-label="Sort by price low to high">Low-High</button>
          <button [class.active]="activeFilter === 'price-high'" (click)="sortCourses('price-high')" aria-label="Sort by price high to low">High-Low</button>
        </div>
      </div>
      <!-- <button class="clear-btn" (click)="resetFilters()" aria-label="Clear all filters">Clear Filters</button> -->
    </section>
    <section class="courses-grid">
      <article class="course-card" *ngFor="let course of allCourses">
        <img [src]="course.image" alt="{{ course.title }}" (error)="onImageError($event, course)" class="course-image">
        <p *ngIf="!course.image || course.image === 'assets/placeholder.jpg'" class="no-image">No image available</p>
        <h3 class="course-title">{{ course.title }}</h3>
        <p class="course-description">{{ course.description }}</p>
        <p class="course-price">Price: {{ course.price }} NGN</p>
        <div class="course-actions">
          <button class="btn btn-primary" (click)="enrollCourse(course.id)" aria-label="Enroll in {{ course.title }}">Enroll</button>
          <button class="btn btn-secondary" aria-label="View details for {{ course.title }}">View Details</button>
        </div>
      </article>
    </section>
  </main>
  <!-- Enrolled Courses Modal -->
  <div class="modal" [class.show]="showEnrolledModal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>My Enrolled Courses</h2>
        <button class="close-modal" (click)="toggleEnrolledModal()" aria-label="Close enrolled courses modal">‚úï</button>
      </div>
      <section class="enrolled-courses-grid">
        <article class="course-card" *ngFor="let course of enrolledCourses">
          <div class="progress-bar" *ngIf="course.progress" role="progressbar" [attr.aria-valuenow]="course.progress" aria-valuemin="0" aria-valuemax="100">
            <div class="progress-fill" [style.width]="course.progress + '%'"></div>
          </div>
          <img [src]="course.image" alt="{{ course.title }}" (error)="onImageError($event, course)" class="course-image">
          <p *ngIf="!course.image || course.image === 'assets/placeholder.jpg'" class="no-image">No image available</p>
          <h3 class="course-title">{{ course.title }}</h3>
          <p class="course-description">{{ course.description }}</p>
          <p class="course-price">Price: {{ course.price }} NGN</p>
          <a class="btn btn-secondary" [routerLink]="['/course', course.id]" aria-label="View details for {{ course.title }}">View Details</a>
        </article>
      </section>
    </div>
  </div>
</div>